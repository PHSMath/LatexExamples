\documentclass[svgnames]{article}
\usepackage{amsmath, mathtools,tikz}
\usepackage{xcolor}
\usepackage{bigstrut}

    \newcommand{\xmathline}[2][]{%
      \ext@arrow 0099\xmathlinefill@{#1}{#2}}%
    \newcommand{\xmathlinefill@}{%
      \arrowfill@{\relbar\bigstrut}\relbar\relbar}
    \makeatother

\begin{document}

\begin{align*}
\displaystyle\int 3x^{2}(x^{3}+1)^{10}\ dx &=\int (\textcolor{red}
   {x^{3}+1})^{10} \textcolor{blue}{3x^{2}\ dx}
   \quad\xmathline{\text{\color{Crimson}substitution\quad}}\colorbox{NavajoWhite! 60}{$\begin{aligned} u & = x^3 + 1 \\ du & =3x^2\,dx \end{aligned} $} \\%
                                       &=\int \textcolor{red}{u}^{10}
   \textcolor{blue}{du}
\end{align*}

\end{document} 
